---
title: 用 R 批量拆分数据后写入 Excel
date: '2024-04-07'
linkTitle: https://cxy.cc/post/2024/04/07/r-excel/
source: 首页 on 楚新元 | All in R
description: |-
  工作中经常会遇到数据拆分和合并问题。例如，需要将多个部门的考核表汇总后，按照数据提供部门分组拆分到多个文件中，方便数据提供部门报送数据。其中将多个文件批量汇总比较简单，可以参考我之前发的博文用 R 批量汇总 Excel 文件里的数据，汇总后，按照某个关键字段拆分后写入到多个文件以前也不难，可能许多读者工作中也会遇到，将来的我也可能再次遇到，所以有必要写一篇博文记录下代码实现的整个过程。
  这里我们以著名的鸢尾花数据为例。其中 Species 字段包含三种类型的鸢尾花名称，分别是 setosa、versicolor、virginica，现在我们需要将 iris 数据集按照 Species 字段拆分成三个数据框，并分别用 group_nest 和 split 两种方式将数据写入到 Excel 文件，包括： 写入到 3 个 Excel 文件 写入到 1 个 Excel 文件的 3 个 Sheet ...
disable_comments: true
---
工作中经常会遇到数据拆分和合并问题。例如，需要将多个部门的考核表汇总后，按照数据提供部门分组拆分到多个文件中，方便数据提供部门报送数据。其中将多个文件批量汇总比较简单，可以参考我之前发的博文用 R 批量汇总 Excel 文件里的数据，汇总后，按照某个关键字段拆分后写入到多个文件以前也不难，可能许多读者工作中也会遇到，将来的我也可能再次遇到，所以有必要写一篇博文记录下代码实现的整个过程。
这里我们以著名的鸢尾花数据为例。其中 Species 字段包含三种类型的鸢尾花名称，分别是 setosa、versicolor、virginica，现在我们需要将 iris 数据集按照 Species 字段拆分成三个数据框，并分别用 group_nest 和 split 两种方式将数据写入到 Excel 文件，包括： 写入到 3 个 Excel 文件 写入到 1 个 Excel 文件的 3 个 Sheet ...